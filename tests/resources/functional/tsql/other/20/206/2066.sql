-- tsql sql:
EXEC sp_create_plan_guide @name = N'Guide6', @stmt = N'WITH EmployeeCTE AS (SELECT EmployeeID, ManagerID, ContactID, Title FROM (VALUES (1, 3, 1, ''Manager''), (2, 3, 2, ''Employee''), (3, NULL, 3, ''CEO'')) AS Employee(EmployeeID, ManagerID, ContactID, Title)), ContactCTE AS (SELECT ContactID, LastName, FirstName FROM (VALUES (1, ''Doe'', ''John''), (2, ''Smith'', ''Jane''), (3, ''Johnson'', ''Bob'')) AS Contact(ContactID, LastName, FirstName)) SELECT e.ManagerID, c.LastName, c.FirstName, e.Title FROM EmployeeCTE AS e JOIN ContactCTE AS c ON e.ContactID = c.ContactID WHERE e.ManagerID = 3 OPTION (TABLE HINT(e))', @type = N'SQL', @module_or_batch = NULL, @params = NULL, @hints = N'OPTION (TABLE HINT(e))';
