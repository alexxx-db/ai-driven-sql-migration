--Query type: DQL
WITH temp_result AS ( SELECT p_brand, p_container, l_quantity FROM lineitem ) SELECT p_brand, p_container, l_quantity, COUNT(l_quantity) OVER ( PARTITION BY p_brand ORDER BY p_container RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW ) AS count_l_quantity_Range_Pre, SUM(l_quantity) OVER ( PARTITION BY p_brand ORDER BY p_container RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW ) AS sum_l_quantity_Range_Pre, AVG(l_quantity) OVER ( PARTITION BY p_brand ORDER BY p_container RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW ) AS avg_l_quantity_Range_Pre, MIN(l_quantity) OVER ( PARTITION BY p_brand ORDER BY p_container RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW ) AS min_l_quantity_Range_Pre, MAX(l_quantity) OVER ( PARTITION BY p_brand ORDER BY p_container RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW ) AS max_l_quantity_Range_Pre FROM temp_result ORDER BY p_brand, p_container;
