-- Teradata sql
CREATE SET TABLE db_ods.COUP_LHSALES ,FALLBACK ,
NO BEFORE JOURNAL,
NO AFTER JOURNAL,
CHECKSUM = DEFAULT,
DEFAULT MERGEBLOCKRATIO,
MAP = TD_MAP1
(
    AIRL_NUM CHAR(4) CHARACTER SET LATIN NOT CASESPECIFIC NOT NULL,
TIX_NUM CHAR(11) CHARACTER SET LATIN NOT CASESPECIFIC NOT NULL,
COUP_NUM CHAR(2) CHARACTER SET LATIN NOT CASESPECIFIC NOT NULL,
REAL_SELLING_DT DATE FORMAT 'YYYYMMDD' NOT NULL,
AGNT_RPTING_CRNCY_CD CHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('CAD','CHF','CNY','CZK','DKK','EUR','GBP','HUF','INR','JPY','NOK','PLN','SEK','USD'),
BKD_CLS_CD CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS 'K',
CREDIT_CRD_NUM VARCHAR(20) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ,
CREDIT_CRD_INSTITUTE_NM CHAR(2) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('  ','AX','CA','IB','MC','TP','VI'),
DISCNT_CD CHAR(6) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('      ','CH25  ','GR    ','OPF   ','OPFP  ','OSPF  ','OY01  '),
ERSP_AGNT_ID INTEGER COMPRESS (0 ,-999999999 ),
ERSP_CD VARCHAR(10) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('?','ERSP'),
ERSP_SOURCE_CD CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS '?',
ERSP_ONLINE_IND CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS 'N',
ETIX_TYP_CD CHAR(2) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS 'PT',
ETIX_IND CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS 'N',
FIRST_CONJ_TIX_NUM CHAR(11) CHARACTER SET LATIN NOT CASESPECIFIC,
FRBS_CLS_CD CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS 'K',
FRBS_MODIFIER_CD CHAR(6) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('      ','AX1   ','CLS0D ','LGT0D ','NC81D0','NCDEW ','SWISS '),
FRBS_SEASON_CD CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ' ',
FRBS_SCND_CD CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ' ',
FRBS_TICKET_DESIGNATOR_CD VARCHAR(15) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS '               ',
FRBS_TYP_CLS_CD CHAR(2) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS 'I5',
ISSUED_AGNT_CD CHAR(8) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('05101153','25000060','25000305','70502624','70507110','72601030','72601393','73007842','73020512','73508025','76901406','87502754','88201308','89600604'),
ISSUED_AGNT_ID INTEGER COMPRESS (15740685 ,151077 ,4028727 ,9875256 ,21600318 ,8784710 ,102486 ,17763170 ,10306427 ,22719900 ,12279197 ,9868720 ,7351736 ,8066786 ),
NTP_STP_CD CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS 'S',
OVERRIDING_COMM_EUR_AMT DECIMAL(7,2) COMPRESS 0.00 ,
PAF_IND CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS 'N',
PAID_COMP_CD CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS 'M',
PAX_TYP_CLS_CD CHAR(2) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS '  ',
PLAN_AIRL_CD CHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS 'LH ',
PLAN_ARR_CITY_CD CHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('BRU','FRA','LON','MUC','NYC','VIE','ZRH'),
PLAN_CITY_PAIR_VV_CD CHAR(7) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('       ','BCN-FRA','BER-FRA','BER-MUC','DUS-MUC','FRA-HAM','FRA-LON','FRA-MUC','FRA-NYC','FRA-VIE','HAM-MUC','LON-MUC','LON-ZRH','VIE-ZRH'),
PLAN_CO_SEG_ID INTEGER COMPRESS 0 ,
PLAN_DEP_CITY_CD CHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('BRU','FRA','LON','MUC','NYC','VIE','ZRH'),
PLAN_DEP_DT DATE FORMAT 'YY/MM/DD',
PLAN_DEP_YR_MON INTEGER COMPRESS 0 ,
PLAN_OPERATING_FLT_NUM CHAR(5) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS '00000',
PLAN_JRNY_START_DT DATE FORMAT 'YY/MM/DD',
PLAN_OPERATING_AIRL_CD CHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('4U ','AC ','LH ','LX ','OS ','SN ','UA '),
REAL_SELLING_YR_MON INTEGER,
REV_IND CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS 'Y',
REVESTIM_IND CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS 'N',
RPTED_SELLING_DT DATE FORMAT 'YY/MM/DD',
RPTING_AGNT_CD CHAR(8) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('05102246','25000001','25000305','70502624','72601030','72601393','73001533','73020512','73508025','76901406','87517185','88202045','88906402','89600604'),
RPTING_AGNT_ID INTEGER COMPRESS (7952386 ,3709958 ,15740685 ,15086625 ,151077 ,3210534 ,4028727 ,9875256 ,21600318 ,102486 ,17763170 ,4107118 ,10306427 ,259208 ,10236599 ,7351736 ,28980944 ,2674907 ,21696989 ,2269405 ,20629755 ),
BO_AGENT_ID INTEGER COMPRESS (7952386 ,3709958 ,15740685 ,15086625 ,151077 ,3210534 ,4028727 ,9875256 ,21600318 ,102486 ,17763170 ,4107118 ,10306427 ,259208 ,10236599 ,7351736 ,28980944 ,2674907 ,21696989 ,2269405 ,20629755 ),
SALES_DEST_CITY_CD CHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('BCN','BER','BRU','DUS','FRA','GVA','HAM','LON','MUC','NYC','PAR','ROM','VIE','ZRH'),
SALES_ORIG_CITY_CD CHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('BER','BRU','DUS','FRA','GVA','HAM','LON','MUC','NYC','PAR','VIE','YTO','ZRH','ZZZ'),
SALES_ORIG_DEST_CITY_PR_VV_CD CHAR(7) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('       ','BCN-FRA','BER-FRA','BER-MUC','BER-ZRH','CGN-MUC','DUS-MUC','FRA-HAM','FRA-LON','FRA-MUC','FRA-NYC','FRA-VIE','GVA-LON','HAM-MUC','HAM-ZRH','LON-MUC','LON-NYC','LON-YTO','LON-ZRH','VIE-ZRH','ZZZ-ZZZ'),
SALES_SUPPLIER_CD CHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('   ','AET','AGT','AMA','ARC','BSP','EDS','EMD','ETA','GAL','OWN','PEV','PSS','TST'),
TOUR_ARRANGEMENT_CD VARCHAR(15) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('               ','294UA          ','ITSEAMAN       ','T5ZBTA         ','267BR          ','LA0032         ','815ZU          ','IT2SNBENPG     ','IT401GBB       ','LA0031         ','ATL1           ','IT402GBT       ','ITUKNET        ','IT3YY2VA       '),
TRANSFER_TYP_CD CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS 'U',
GGROSS_JRNY_EUR_AMT DECIMAL(9,2) COMPRESS (0.00 ,31.00 ,75.00 ,29.00 ,70.00 ,24.00 ,65.00 ,50.00 ,35.00 ,30.00 ,25.00 ,20.00 ,15.00 ,10.00 ),
GGROSS_SALE_EUR_AMT DECIMAL(9,2) COMPRESS (0.00 ,31.00 ,75.00 ,29.00 ,70.00 ,24.00 ,65.00 ,50.00 ,35.00 ,30.00 ,25.00 ,20.00 ,15.00 ,10.00 ),
GGROSS_SALE_YQ_EUR_AMT DECIMAL(9,2) COMPRESS (0.00 ,100.00 ,29.00 ,70.00 ,65.00 ,50.00 ,40.00 ,35.00 ,30.00 ,25.00 ,43.00 ,20.00 ,15.00 ,10.00 ),
GGROSS_SALE_LOC_AMT DECIMAL(13,2) COMPRESS (0.00 ,100.00 ,31.00 ,49.00 ,11.00 ,75.00 ,29.00 ,70.00 ,24.00 ,65.00 ,19.00 ,60.00 ,50.00 ,35.00 ,12.00 ,30.00 ,25.00 ,20.00 ,15.00 ,10.00 ,28.00 ),
GGROSS_SALE_YQ_LOC_AMT DECIMAL(13,2) COMPRESS (0.00 ,100.00 ,49.00 ,11.00 ,75.00 ,29.00 ,70.00 ,65.00 ,19.00 ,60.00 ,50.00 ,45.00 ,40.00 ,35.00 ,12.00 ,30.00 ,25.00 ,43.00 ,20.00 ,15.00 ,10.00 ),
GROSS_SALE_EUR_AMT DECIMAL(9,2) COMPRESS (0.00 ,31.00 ,75.00 ,70.00 ,65.00 ,24.37 ,50.00 ,45.00 ,35.00 ,30.00 ,25.00 ,20.00 ,15.00 ,10.00 ),
GROSS_SALE_YQ_EUR_AMT DECIMAL(9,2) COMPRESS (0.00 ,100.00 ,205.00 ,70.00 ,65.00 ,50.00 ,40.00 ,35.00 ,30.00 ,240.00 ,25.00 ,43.00 ,15.00 ,10.00 ),
GROSS_SALE_LOC_AMT DECIMAL(13,2) COMPRESS (0.00 ,100.00 ,31.00 ,8.00 ,49.00 ,11.00 ,75.00 ,29.00 ,70.00 ,65.00 ,19.00 ,60.00 ,50.00 ,45.00 ,35.00 ,12.00 ,30.00 ,25.00 ,20.00 ,15.00 ,10.00 ),
GROSS_SALE_YQ_LOC_AMT DECIMAL(13,2) COMPRESS (0.00 ,100.00 ,49.00 ,11.00 ,75.00 ,29.00 ,70.00 ,65.00 ,19.00 ,60.00 ,50.00 ,40.00 ,35.00 ,12.00 ,30.00 ,240.00 ,25.00 ,43.00 ,20.00 ,15.00 ,10.00 ),
NETNET_SALE_EUR_AMT DECIMAL(9,2) COMPRESS (0.00 ,31.00 ,8.40 ,75.00 ,70.00 ,24.00 ,65.00 ,24.37 ,50.00 ,30.00 ,25.00 ,20.00 ,15.00 ,10.00 ),
NETNET_SALE_YQ_EUR_AMT DECIMAL(9,2) COMPRESS (0.00 ,100.00 ,8.40 ,70.00 ,65.00 ,24.37 ,50.00 ,40.00 ,30.00 ,25.00 ,43.00 ,20.00 ,15.00 ,10.00 ),
NETNET_SALE_LOC_AMT DECIMAL(13,2) COMPRESS (0.00 ,100.00 ,31.00 ,49.00 ,8.40 ,11.00 ,75.00 ,29.00 ,70.00 ,65.00 ,19.00 ,60.00 ,24.37 ,50.00 ,35.00 ,12.00 ,30.00 ,25.00 ,20.00 ,15.00 ,10.00 ),
NETNET_SALE_YQ_LOC_AMT DECIMAL(13,2) COMPRESS (0.00 ,100.00 ,49.00 ,11.00 ,75.00 ,29.00 ,70.00 ,65.00 ,19.00 ,60.00 ,24.37 ,50.00 ,40.00 ,35.00 ,12.00 ,30.00 ,25.00 ,43.00 ,20.00 ,15.00 ,10.00 ),
NET_SALE_EUR_AMT DECIMAL(9,2) COMPRESS (0.00 ,31.00 ,75.00 ,70.00 ,65.00 ,24.37 ,50.00 ,45.00 ,35.00 ,30.00 ,25.00 ,20.00 ,15.00 ,10.00 ),
NET_SALE_YQ_EUR_AMT DECIMAL(9,2) COMPRESS (0.00 ,100.00 ,75.00 ,70.00 ,65.00 ,50.00 ,40.00 ,35.00 ,30.00 ,25.00 ,43.00 ,20.00 ,15.00 ,10.00 ),
NET_SALE_LOC_AMT DECIMAL(13,2) COMPRESS (0.00 ,100.00 ,31.00 ,8.00 ,49.00 ,11.00 ,75.00 ,29.00 ,70.00 ,65.00 ,19.00 ,60.00 ,50.00 ,40.00 ,35.00 ,12.00 ,30.00 ,25.00 ,20.00 ,15.00 ,10.00 ),
NET_SALE_YQ_LOC_AMT DECIMAL(13,2) COMPRESS (0.00 ,100.00 ,49.00 ,11.00 ,75.00 ,29.00 ,70.00 ,65.00 ,19.00 ,60.00 ,50.00 ,40.00 ,35.00 ,12.00 ,30.00 ,240.00 ,25.00 ,43.00 ,20.00 ,15.00 ,10.00 ),
LRS_CREATE_DT DATE FORMAT 'YY/MM/DD',
CO_UPD_TMS TIMESTAMP(0),
DOC_TYP_CD CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('E','M','T'),
SALES_TYP_CD CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('E','S'),
PLAN_DEP_UTC_DT DATE FORMAT 'YY/MM/DD',
PLAN_FLT_NUM CHAR(5) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('00000','00052','00084','00400','00455','00456','00457','00462','00463','00501','00728','00729','00778','00779'),
PLAN_OPERATING_FLOWNER_CD CHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('   ','AUA','CLH','DAT','DLH','SWR','TYR'),
DIRECTION_IND CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('I','O','U'),
EXCHGE_ISSUING_AIRL_NUM CHAR(4) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('    ','016 ','082 ','205 ','220 ','257 ','724 '),
EXCHGE_ISSUING_TIX_NUM CHAR(11) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('           ','2013824685 ','2013824982 ','2013827819 ','2015586075 ','2015701453 ','2016314211 ','2017313920 ','2704308580 ','2704436855 ','2704554566 ','2704653177 ','2705650762 ','2705671418 '),
JRNY_SEQ_NUM CHAR(2) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('01','02','03','04','05','06','07'),
TRANS_DT DATE FORMAT 'YY/MM/DD',
RPTED_USAGE_DT DATE FORMAT 'YY/MM/DD',
USE_TYP_CD CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC DEFAULT ' ' COMPRESS ' ',
BO_INDICATOR_ID CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC DEFAULT 'N' COMPRESS (' ','N','Y'),
EDITED_TOUR_CODE_ID CHAR(15) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('               ','1OS2AER257     ','267BR          ','267IN          ','294UA          ','401GB          ','402GB          ','603JS          ','815ZU          ','ALTSJV         ','C002830        ','C021811        ','HUMANIT        ','LA0031         ','LA0032         ','SEAMAN         ','SNBENPG        ','T5ZBTA         ','TOSCA          ','UKNET          ','ZBTA           '),
PPT_TD_ID CHAR(4) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('    ','BTTO','BTY3','II11','OPF ','OPFP','SCWW'),
PUBLISHED_INDICATOR_ID CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ' ',
CORP_INDICATOR_ID CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC DEFAULT 'N' COMPRESS 'N',
CORP_LVL_E_UC_ID DECIMAL(14,0) COMPRESS 0. ,
CORP_LVL_A_UC_ID DECIMAL(14,0) COMPRESS 0. ,
TRACKING_TYPE_CODE_ID CHAR(10) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('          ','?         ','CC        ','CLID      ','IMPLANT   ','OSI       ','TC        ','TCUA      '),
TRACKING_CD VARCHAR(20) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS '0',
FLT_DIV_CD CHAR(6) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('?     ','DIRECT','FRA   ','MUC   '),
FLT_HUB_CD CHAR(7) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('DUS    ','FRA    ','MUC    ','NON-HUB'),
OSI_CD VARCHAR(19) CHARACTER SET LATIN NOT CASESPECIFIC NOT NULL DEFAULT '',
SUPPLIER_CD CHAR(2) CHARACTER SET LATIN NOT CASESPECIFIC NOT NULL DEFAULT '  ' COMPRESS ('LH','LX'),
PLAN_DOMESTIC_INDICATOR_ID CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS (' ','N','Y'),
GGROSS_JRNY_EUR_TAX_AMT DECIMAL(9,2) COMPRESS (0.00 ,100.00 ,75.00 ,70.00 ,65.00 ,60.00 ,50.00 ,150.00 ,30.00 ,25.00 ,130.00 ,20.00 ,15.00 ,10.00 ),
GGROSS_JRNY_EUR_TOT_AMT DECIMAL(9,2) COMPRESS (0.00 ,100.00 ,90.00 ,75.00 ,70.00 ,65.00 ,50.00 ,150.00 ,30.00 ,25.00 ,15.00 ,120.00 ,10.00 ,110.00 ),
GDS_CD VARCHAR(4) CHARACTER SET LATIN NOT CASESPECIFIC NOT NULL DEFAULT '    ' COMPRESS '    ',
JVTS_APLUS2_INDICATOR_ID CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC DEFAULT 'N' COMPRESS 'N',
JVTS_APLUS2_TYPE_ID CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC DEFAULT ' ' COMPRESS ' ',
JVTS_JPLUS_INDICATOR_ID CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC DEFAULT 'N' COMPRESS 'N',
JVTS_JPLUS_TYPE_ID CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC DEFAULT ' ' COMPRESS ' ',
JVTS_SPLUS_INDICATOR_ID CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC DEFAULT 'N' COMPRESS 'N',
JVTS_SPLUS_TYPE_ID CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC DEFAULT ' ' COMPRESS ' ',
CLUSTER_CD CHAR(2) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('01','02','03','04','05','06','07','08','09','10','14','15','16','??'),
RESTRIKTIONSMODUL_CD CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('?','H','J','K','M','N','Q','T','Y'),
MINSTAY_OW_CD CHAR(2) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('??','D0','D1','D2','D3','D4','D5','D6','D7','D8','D9','OW','W0','W1','W2','W3','W4','W5','W6','W7','W8','W9'),
PLAN_DEP_AIRP_CD CHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('BRU','DUS','EWR','FRA','GVA','HAM','IAD','LHR','MUC','ORD','TXL','VIE','YYZ','ZRH'),
PLAN_ARR_AIRP_CD CHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('BRU','DUS','EWR','FRA','GVA','HAM','IAD','LHR','MUC','ORD','TXL','VIE','YYZ','ZRH'),
PLAN_AIRP_PAIR_VV_CD CHAR(7) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('       ','BCN-FRA','DUS-MUC','FRA-HAM','FRA-LHR','FRA-MUC','FRA-ORD','FRA-SFO','FRA-TXL','FRA-VIE','HAM-MUC','LHR-MUC','MUC-TXL','VIE-ZRH'),
PRIM_TIX_NUM CHAR(11) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('           ','2328893629 ','2333346782 ','2333712947 ','2338423763 ','2342566057 ','2346798057 ','2348450411 ','2355725661 ','2359426538 ','2372795709 ','2400153691 ','2400187767 '),
CLIENT_IDENT_CD VARCHAR(19) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('                   ','C200000037767      ','C100107121791      ','C100107123396      ','C100107370541      ','C100107121170      '),
EMD_REASN_ISS_CD CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ' ',
EMD_REASN_ISS_SUB_CD CHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('   ','0B5','0CC','0GO','993','996'),
BUSINESS_UNIT_ID CHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('   ','D4U','LHP'),
TARIFF_ID INTEGER COMPRESS (1 ,575 ,576 ,370 ,376 ,377 ,385 ,405 ,406 ,415 ,418 ,431 ,441 ,442 ,444 ,445 ,446 ,463 ,490 ,491 ,501 ),
FEE_MCO_IND CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ,
EMD_CONN_AIRL_NUM CHAR(4) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('    ','014 ','016 ','220 ','257 ','724 '),
EMD_CONN_TIX_NUM CHAR(11) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('           ','0000000000 ','1051406420 ','1111111111 ','1234567890 ','1735998469 ','2137904457 ','2303709986 ','2304224999 ','5555555555 ','9188939657 ','9668551746 ','9999999999 '),
EMD_CONN_COUP_NUM CHAR(2) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('  ','00','01','02','03','04'),
FBA_CD CHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('   ','0PC','1PC','2PC','NIL','PC1'),
FARE_BUNDLE_ID CHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC DEFAULT '   ' COMPRESS ('   ','BUZ','CLS','FLX','LGT'),
BOOKSTAT_CD CHAR(2) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('NS','OK','RQ','SA'),
TRANS_IND CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ,
PNR_CD CHAR(13) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS '             ',
OC_CRNCY_CD CHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('   ','CAD','CHF','CNY','DKK','EUR','GBP','HUF','INR','NOK','PLN','SEK','USD'),
GGROSS_JRNY_OC_AMT DECIMAL(13,2) COMPRESS (0.00 ,70.00 ,65.00 ,50.00 ,30.00 ,15.00 ),
GGROSS_JRNY_OC_TAX_AMT DECIMAL(13,2) COMPRESS (0.00 ,58.00 ,30.00 ,25.00 ,15.00 ),
GGROSS_JRNY_OC_TAX_OB_AMT DECIMAL(13,2) COMPRESS (0.00 ,58.00 ,30.00 ,25.00 ,15.00 ,10.00 ),
FC_TAR_ORIG_CITY_CD CHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('   ','BCN','BER','CGN','DUS','FRA','HAM','LON','MIL','MUC','PAR','STR','VIE'),
FC_TAR_DEST_CITY_CD CHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('   ','BCN','BER','CGN','DUS','FRA','HAM','LON','MIL','MUC','PAR','STR','VIE'),
FC_GGROSS_TAROND_NUC_AMT DECIMAL(13,2) COMPRESS (0.00 ,21.00 ,29.00 ,25.00 ,20.00 ,15.00 ),
FC_SURC_TAROND_NUC_AMT DECIMAL(13,2) COMPRESS (0.00 ,5.79 ,5.80 ,240.00 ,25.00 ,15.00 ),
FC_PLAN_AIRL_CD CHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('   ','4U ','LH ','LX ','OS ','UA '),
FC_SURC_NUC_AMT DECIMAL(13,2) COMPRESS (0.00 ,5.79 ,5.80 ,4.25 ,25.00 ,15.00 ),
FC_GGROSS_JRNY_NUC_TAX_AMT DECIMAL(13,2) COMPRESS (0.00 ,42.00 ,40.00 ,58.00 ,30.00 ,15.00 ),
ORIG_AIRL_NUM CHAR(4) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('014 ','016 ','082 ','220 ','257 ','724 '),
ORIG_TIX_NUM CHAR(11) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ,
ORIG_REAL_SELLING_DT DATE FORMAT 'YYYYMMDD',
CREDIT_CRD_NUM_2 VARCHAR(20) CHARACTER SET LATIN NOT CASESPECIFIC,
CREDIT_CRD_NUM_3 VARCHAR(20) CHARACTER SET LATIN NOT CASESPECIFIC,
BTC_CMPNY_NM VARCHAR(250) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('','CONCUR'),
SP_CC_CD CHAR(2) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('  ','AX','DC','MC','TP','VI'),
FARE_OWNER_CD CHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('   ','4U ','EW ','LH ','LX ','OS '),
INVOL_JRNY_IND CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ,
INVOL_CPN_IND CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ,
AWARD_EUR_AMT DECIMAL(9,2) COMPRESS 0.00 ,
AWARD_LOC_AMT DECIMAL(13,2) COMPRESS 0.00 ,
MPA_EUR_AMT DECIMAL(9,2) COMPRESS 0.00 ,
MPA_LOC_AMT DECIMAL(13,2) COMPRESS 0.00 ,
FCMI_CD CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ,
FCPI_CD CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ,
CONF_WGHT_INT_CD CHAR(2) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('00','01','02','03','04','05'))
PRIMARY INDEX XIE2COUP_LHSALES_DIV ( AIRL_NUM ,TIX_NUM ,COUP_NUM )
PARTITION BY RANGE_N(REAL_SELLING_DT  BETWEEN DATE '2001-01-01' AND DATE '2030-12-31' EACH INTERVAL '1' DAY )
INDEX XPKCOUP_LHSALES ( AIRL_NUM ,TIX_NUM ,COUP_NUM ,REAL_SELLING_DT )
INDEX XIE1COUP_LHSALES ( LRS_CREATE_DT )
INDEX XIE3COUP_LHSALES ( PLAN_DEP_CITY_CD )
INDEX XIE5COUP_LHSALES ( PLAN_DEP_DT )
INDEX XIE6COUP_LHSALES ( PLAN_OPERATING_FLT_NUM )
INDEX XIE7COUP_LHSALES ( BO_AGENT_ID )
INDEX XIE8COUP_LHSALES ( RPTING_AGNT_ID )
INDEX XIE4COUP_LHSALES ( PLAN_ARR_CITY_CD )
INDEX XIE10COUP_LHSALES ( TIX_NUM )
INDEX XNUSI02_LHSALES ( ISSUED_AGNT_ID )
INDEX XNUSI04_LHSALES ( RPTED_SELLING_DT )
INDEX XNUSI05_LHSALES ( REAL_SELLING_YR_MON )
INDEX XNUSI07_LHSALES ( SALES_ORIG_DEST_CITY_PR_VV_CD )
INDEX XNUSI08_LHSALES ( SALES_ORIG_CITY_CD )
INDEX XNUSI09_LHSALES ( SALES_DEST_CITY_CD );

-- dbsql

CREATE TABLE db_ods.COUP_LHSALES (
                                     AIRL_NUM STRING NOT NULL,
                                     TIX_NUM STRING NOT NULL,
                                     COUP_NUM STRING NOT NULL,
                                     REAL_SELLING_DT DATE NOT NULL,
                                     AGNT_RPTING_CRNCY_CD STRING,
                                     BKD_CLS_CD STRING,
                                     CREDIT_CRD_NUM STRING,
                                     CREDIT_CRD_INSTITUTE_NM STRING,
                                     DISCNT_CD STRING,
                                     ERSP_AGNT_ID INT,
                                     ERSP_CD STRING,
                                     ERSP_SOURCE_CD STRING,
                                     ERSP_ONLINE_IND STRING,
                                     ETIX_TYP_CD STRING,
                                     ETIX_IND STRING,
                                     FIRST_CONJ_TIX_NUM STRING,
                                     FRBS_CLS_CD STRING,
                                     FRBS_MODIFIER_CD STRING,
                                     FRBS_SEASON_CD STRING,
                                     FRBS_SCND_CD STRING,
                                     FRBS_TICKET_DESIGNATOR_CD STRING,
                                     FRBS_TYP_CLS_CD STRING,
                                     ISSUED_AGNT_CD STRING,
                                     ISSUED_AGNT_ID INT,
                                     NTP_STP_CD STRING,
                                     OVERRIDING_COMM_EUR_AMT DECIMAL(7, 2),
                                     PAF_IND STRING,
                                     PAID_COMP_CD STRING,
                                     PAX_TYP_CLS_CD STRING,
                                     PLAN_AIRL_CD STRING,
                                     PLAN_ARR_CITY_CD STRING,
                                     PLAN_CITY_PAIR_VV_CD STRING,
                                     PLAN_CO_SEG_ID INT,
                                     PLAN_DEP_CITY_CD STRING,
                                     PLAN_DEP_DT DATE,
                                     PLAN_DEP_YR_MON INT,
                                     PLAN_OPERATING_FLT_NUM STRING,
                                     PLAN_JRNY_START_DT DATE,
                                     PLAN_OPERATING_AIRL_CD STRING,
                                     REAL_SELLING_YR_MON INT,
                                     REV_IND STRING,
                                     REVESTIM_IND STRING,
                                     RPTED_SELLING_DT DATE,
                                     RPTING_AGNT_CD STRING,
                                     RPTING_AGNT_ID INT,
                                     BO_AGENT_ID INT,
                                     SALES_DEST_CITY_CD STRING,
                                     SALES_ORIG_CITY_CD STRING,
                                     SALES_ORIG_DEST_CITY_PR_VV_CD STRING,
                                     SALES_SUPPLIER_CD STRING,
                                     TOUR_ARRANGEMENT_CD STRING,
                                     TRANSFER_TYP_CD STRING,
                                     GGROSS_JRNY_EUR_AMT DECIMAL(9, 2),
                                     GGROSS_SALE_EUR_AMT DECIMAL(9, 2),
                                     GGROSS_SALE_YQ_EUR_AMT DECIMAL(9, 2),
                                     GGROSS_SALE_LOC_AMT DECIMAL(13, 2),
                                     GGROSS_SALE_YQ_LOC_AMT DECIMAL(13, 2),
                                     GROSS_SALE_EUR_AMT DECIMAL(9, 2),
                                     GROSS_SALE_YQ_EUR_AMT DECIMAL(9, 2),
                                     GROSS_SALE_LOC_AMT DECIMAL(13, 2),
                                     GROSS_SALE_YQ_LOC_AMT DECIMAL(13, 2),
                                     NETNET_SALE_EUR_AMT DECIMAL(9, 2),
                                     NETNET_SALE_YQ_EUR_AMT DECIMAL(9, 2),
                                     NETNET_SALE_LOC_AMT DECIMAL(13, 2),
                                     NETNET_SALE_YQ_LOC_AMT DECIMAL(13, 2),
                                     NET_SALE_EUR_AMT DECIMAL(9, 2),
                                     NET_SALE_YQ_EUR_AMT DECIMAL(9, 2),
                                     NET_SALE_LOC_AMT DECIMAL(13, 2),
                                     NET_SALE_YQ_LOC_AMT DECIMAL(13, 2),
                                     LRS_CREATE_DT DATE,
                                     CO_UPD_TMS TIMESTAMP_NTZ,
                                     DOC_TYP_CD STRING,
                                     SALES_TYP_CD STRING,
                                     PLAN_DEP_UTC_DT DATE,
                                     PLAN_FLT_NUM STRING,
                                     PLAN_OPERATING_FLOWNER_CD STRING,
                                     DIRECTION_IND STRING,
                                     EXCHGE_ISSUING_AIRL_NUM STRING,
                                     EXCHGE_ISSUING_TIX_NUM STRING,
                                     JRNY_SEQ_NUM STRING,
                                     TRANS_DT DATE,
                                     RPTED_USAGE_DT DATE,
                                     USE_TYP_CD STRING DEFAULT ' ',
                                     BO_INDICATOR_ID STRING DEFAULT 'N',
                                     EDITED_TOUR_CODE_ID STRING,
                                     PPT_TD_ID STRING,
                                     PUBLISHED_INDICATOR_ID STRING,
                                     CORP_INDICATOR_ID STRING DEFAULT 'N',
                                     CORP_LVL_E_UC_ID DECIMAL(14, 0),
                                     CORP_LVL_A_UC_ID DECIMAL(14, 0),
                                     TRACKING_TYPE_CODE_ID STRING,
                                     TRACKING_CD STRING,
                                     FLT_DIV_CD STRING,
                                     FLT_HUB_CD STRING,
                                     OSI_CD STRING NOT NULL DEFAULT '',
                                     SUPPLIER_CD STRING NOT NULL DEFAULT '  ',
                                     PLAN_DOMESTIC_INDICATOR_ID STRING,
                                     GGROSS_JRNY_EUR_TAX_AMT DECIMAL(9, 2),
                                     GGROSS_JRNY_EUR_TOT_AMT DECIMAL(9, 2),
                                     GDS_CD STRING NOT NULL DEFAULT '    ',
                                     JVTS_APLUS2_INDICATOR_ID STRING DEFAULT 'N',
                                     JVTS_APLUS2_TYPE_ID STRING DEFAULT ' ',
                                     JVTS_JPLUS_INDICATOR_ID STRING DEFAULT 'N',
                                     JVTS_JPLUS_TYPE_ID STRING DEFAULT ' ',
                                     JVTS_SPLUS_INDICATOR_ID STRING DEFAULT 'N',
                                     JVTS_SPLUS_TYPE_ID STRING DEFAULT ' ',
                                     CLUSTER_CD STRING,
                                     RESTRIKTIONSMODUL_CD STRING,
                                     MINSTAY_OW_CD STRING,
                                     PLAN_DEP_AIRP_CD STRING,
                                     PLAN_ARR_AIRP_CD STRING,
                                     PLAN_AIRP_PAIR_VV_CD STRING,
                                     PRIM_TIX_NUM STRING,
                                     CLIENT_IDENT_CD STRING,
                                     EMD_REASN_ISS_CD STRING,
                                     EMD_REASN_ISS_SUB_CD STRING,
                                     BUSINESS_UNIT_ID STRING,
                                     TARIFF_ID INT,
                                     FEE_MCO_IND STRING,
                                     EMD_CONN_AIRL_NUM STRING,
                                     EMD_CONN_TIX_NUM STRING,
                                     EMD_CONN_COUP_NUM STRING,
                                     FBA_CD STRING,
                                     FARE_BUNDLE_ID STRING DEFAULT '   ',
                                     BOOKSTAT_CD STRING,
                                     TRANS_IND STRING,
                                     PNR_CD STRING,
                                     OC_CRNCY_CD STRING,
                                     GGROSS_JRNY_OC_AMT DECIMAL(13, 2),
                                     GGROSS_JRNY_OC_TAX_AMT DECIMAL(13, 2),
                                     GGROSS_JRNY_OC_TAX_OB_AMT DECIMAL(13, 2),
                                     FC_TAR_ORIG_CITY_CD STRING,
                                     FC_TAR_DEST_CITY_CD STRING,
                                     FC_GGROSS_TAROND_NUC_AMT DECIMAL(13, 2),
                                     FC_SURC_TAROND_NUC_AMT DECIMAL(13, 2),
                                     FC_PLAN_AIRL_CD STRING,
                                     FC_SURC_NUC_AMT DECIMAL(13, 2),
                                     FC_GGROSS_JRNY_NUC_TAX_AMT DECIMAL(13, 2),
                                     ORIG_AIRL_NUM STRING,
                                     ORIG_TIX_NUM STRING,
                                     ORIG_REAL_SELLING_DT DATE,
                                     CREDIT_CRD_NUM_2 STRING,
                                     CREDIT_CRD_NUM_3 STRING,
                                     BTC_CMPNY_NM STRING,
                                     SP_CC_CD STRING,
                                     FARE_OWNER_CD STRING,
                                     INVOL_JRNY_IND STRING,
                                     INVOL_CPN_IND STRING,
                                     AWARD_EUR_AMT DECIMAL(9, 2),
                                     AWARD_LOC_AMT DECIMAL(13, 2),
                                     MPA_EUR_AMT DECIMAL(9, 2),
                                     MPA_LOC_AMT DECIMAL(13, 2),
                                     FCMI_CD STRING,
                                     FCPI_CD STRING,
                                     CONF_WGHT_INT_CD STRING
);
